<!doctype html><html lang="zh-CN"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.23" /><meta name="theme" content="VuePress Theme Plume 1.0.0-rc.155" /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"进阶篇","image":[""],"dateModified":"2025-07-07T08:48:09.000Z","author":[]}</script><meta property="og:url" content="https://docs.sreio.com/interview/php/%E8%BF%9B%E9%98%B6%E7%AF%87/"><meta property="og:site_name" content="Sreio Docs"><meta property="og:title" content="进阶篇"><meta property="og:description" content="PHP垃圾回收机制（GC） 使用 引用计数机制 将每个 PHP 变量保存在一个叫 zval 变量容器中。 zval 变量容器 包含 变量的类型、变量值、 is_res、refcount is_ref 用于标识该变量是否为引用集合或变量。 refcount 表示指向当前变量的个数。 默认打开垃圾回收机制, 当发现有存在循环引用的zval时, 就会把其投入..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-07-07T08:48:09.000Z"><meta property="article:modified_time" content="2025-07-07T08:48:09.000Z"><link rel="icon" type="image/png" href="/favicon.ico"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6715279698150024" crossorigin="anonymous"></script><title>进阶篇 | Sreio Docs</title><meta name="description" content="PHP垃圾回收机制（GC） 使用 引用计数机制 将每个 PHP 变量保存在一个叫 zval 变量容器中。 zval 变量容器 包含 变量的类型、变量值、 is_res、refcount is_ref 用于标识该变量是否为引用集合或变量。 refcount 表示指向当前变量的个数。 默认打开垃圾回收机制, 当发现有存在循环引用的zval时, 就会把其投入..."><link rel="preload" href="/assets/style-BXtE0-vj.css" as="style"><link rel="stylesheet" href="/assets/style-BXtE0-vj.css"><link rel="modulepreload" href="/assets/app-DWByWgeb.js"><link rel="modulepreload" href="/assets/index.html-CtirrkK2.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-d90a7a26><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-d5a8d0bc></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-d5a8d0bc> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-d90a7a26 data-v-e98a6132><div class="vp-navbar" vp-navbar data-v-e98a6132 data-v-2c31ea5e><div class="wrapper" data-v-2c31ea5e><div class="container" data-v-2c31ea5e><div class="title" data-v-2c31ea5e><div class="vp-navbar-title has-sidebar" data-v-2c31ea5e data-v-1a4f50af><a class="vp-link link no-icon title" href="/" data-v-1a4f50af><!--[--><!--[--><!--]--><!--[--><!--[--><!--[--><img class="vp-image dark logo" style="" src="/favicon.ico" alt data-v-480e858a><!--]--><!--[--><img class="vp-image light logo" style="" src="/favicon.ico" alt data-v-480e858a><!--]--><!--]--><!--]--><span data-v-1a4f50af>Sreio Docs</span><!--[--><!--]--><!--]--><!----></a></div></div><div class="content" data-v-2c31ea5e><div class="content-body" data-v-2c31ea5e><!--[--><!--]--><div class="vp-navbar-search search" data-v-2c31ea5e><div class="search-wrapper" data-v-97535d1e><!----><div id="local-search" data-v-97535d1e><button type="button" class="mini-search mini-search-button" aria-label="搜索文档" data-v-97535d1e><span class="mini-search-button-container"><span class="mini-search-search-icon vpi-mini-search" aria-label="search icon"></span><span class="mini-search-button-placeholder">搜索文档</span></span><span class="mini-search-button-keys"><kbd class="mini-search-button-key"></kbd><kbd class="mini-search-button-key">K</kbd></span></button></div></div></div><!--[--><!--]--><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-2c31ea5e data-v-d43c1732><span id="main-nav-aria-label" class="visually-hidden" data-v-d43c1732>Main Navigation</span><!--[--><!--[--><a class="vp-link link navbar-menu-link" href="/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><!----><span data-v-d4acf911>首页</span><!----><!--]--><!----></a><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-d43c1732 data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-86530b6c><span class="text" data-v-86530b6c><!----><!----><span data-v-86530b6c>编程语言</span><!----><span class="vpi-chevron-down text-icon" data-v-86530b6c></span></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><div class="items" data-v-709dc2b1><!--[--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/golang/" data-v-1ff1855f><!--[--><!----> Golang <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/php/" data-v-1ff1855f><!--[--><!----> PHP <!----><!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-d43c1732 data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-86530b6c><span class="text" data-v-86530b6c><!----><!----><span data-v-86530b6c>数据库</span><!----><span class="vpi-chevron-down text-icon" data-v-86530b6c></span></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><div class="items" data-v-709dc2b1><!--[--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/mysql/" data-v-1ff1855f><!--[--><!----> MySQL <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/redis/" data-v-1ff1855f><!--[--><!----> Redis <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/mongodb/" data-v-1ff1855f><!--[--><!----> MongoDB <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/clickhouse/" data-v-1ff1855f><!--[--><!----> ClickHouse <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/etcd/" data-v-1ff1855f><!--[--><!----> Etcd <!----><!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-d43c1732 data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-86530b6c><span class="text" data-v-86530b6c><!----><!----><span data-v-86530b6c>DevOps</span><!----><span class="vpi-chevron-down text-icon" data-v-86530b6c></span></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><div class="items" data-v-709dc2b1><!--[--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/docker/" data-v-1ff1855f><!--[--><!----> Docker <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/k8s/" data-v-1ff1855f><!--[--><!----> Kubernetes <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/linux/" data-v-1ff1855f><!--[--><!----> Linux <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/nginx/" data-v-1ff1855f><!--[--><!----> Nginx <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/ELK/" data-v-1ff1855f><!--[--><!----> ELK <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/git/" data-v-1ff1855f><!--[--><!----> Git <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/gitlab/" data-v-1ff1855f><!--[--><!----> GitLab <!----><!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-d43c1732 data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-86530b6c><span class="text" data-v-86530b6c><!----><!----><span data-v-86530b6c>中间件</span><!----><span class="vpi-chevron-down text-icon" data-v-86530b6c></span></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><div class="items" data-v-709dc2b1><!--[--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/queue/" data-v-1ff1855f><!--[--><!----> 消息队列 <!----><!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-d43c1732 data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-86530b6c><span class="text" data-v-86530b6c><!----><!----><span data-v-86530b6c>基础知识</span><!----><span class="vpi-chevron-down text-icon" data-v-86530b6c></span></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><div class="items" data-v-709dc2b1><!--[--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/brain/" data-v-1ff1855f><!--[--><!----> 数据结构与算法 <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/network/" data-v-1ff1855f><!--[--><!----> 网络协议 <!----><!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-d43c1732 data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-86530b6c><span class="text" data-v-86530b6c><!----><!----><span data-v-86530b6c>更多</span><!----><span class="vpi-chevron-down text-icon" data-v-86530b6c></span></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><div class="items" data-v-709dc2b1><!--[--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/ai/" data-v-1ff1855f><!--[--><!----> AI <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/interview/" data-v-1ff1855f><!--[--><!----> 面试宝典 <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/it/" data-v-1ff1855f><!--[--><!----> IT 名词 <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/cpwp/" data-v-1ff1855f><!--[--><!----> 程序员发音 <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/vpn/" data-v-1ff1855f><!--[--><!----> VPN <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/%E9%A9%BE%E7%85%A7%E8%80%83%E8%AF%95/" data-v-1ff1855f><!--[--><!----> 驾照考试 <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/sites/" data-v-1ff1855f><!--[--><!----> 网站导航 <!----><!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!--[--><!--]--><!----><div class="vp-navbar-appearance appearance" data-v-2c31ea5e data-v-a295abf6><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-a295abf6 data-v-596c25a9 data-v-7eb32327><span class="check" data-v-7eb32327><span class="icon" data-v-7eb32327><!--[--><span class="vpi-sun sun" data-v-596c25a9></span><span class="vpi-moon moon" data-v-596c25a9></span><!--]--></span></span></button></div><div class="vp-social-links vp-navbar-social-links social-links" data-v-2c31ea5e data-v-ad52545c data-v-40bac536><!--[--><a class="vp-social-link no-icon" href="https://github.com/sreio/sreio-docs" aria-label="github" target="_blank" rel="noopener" data-v-40bac536 data-v-67b21932><span class="vpi-social-github" /></a><!--]--></div><div class="vp-flyout vp-navbar-extra extra" data-v-2c31ea5e data-v-652282fd data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-86530b6c><span class="vpi-more-horizontal icon" data-v-86530b6c></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><!----><!--[--><!--[--><!----><div class="group" data-v-652282fd><div class="item appearance" data-v-652282fd><p class="label" data-v-652282fd>外观</p><div class="appearance-action" data-v-652282fd><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-652282fd data-v-596c25a9 data-v-7eb32327><span class="check" data-v-7eb32327><span class="icon" data-v-7eb32327><!--[--><span class="vpi-sun sun" data-v-596c25a9></span><span class="vpi-moon moon" data-v-596c25a9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-652282fd><div class="item social-links" data-v-652282fd><div class="vp-social-links social-links-list" data-v-652282fd data-v-40bac536><!--[--><a class="vp-social-link no-icon" href="https://github.com/sreio/sreio-docs" aria-label="github" target="_blank" rel="noopener" data-v-40bac536 data-v-67b21932><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-2c31ea5e data-v-2b50024d><span class="container" data-v-2b50024d><span class="top" data-v-2b50024d></span><span class="middle" data-v-2b50024d></span><span class="bottom" data-v-2b50024d></span></span></button></div></div></div></div><div class="divider" data-v-2c31ea5e><div class="divider-line" data-v-2c31ea5e></div></div></div><!----></header><div class="vp-local-nav reached-top" data-v-d90a7a26 data-v-3944d8e8><button class="menu" aria-expanded="false" aria-controls="SidebarNav" data-v-3944d8e8><span class="vpi-align-left menu-icon" data-v-3944d8e8></span><span class="menu-text" data-v-3944d8e8>Menu</span></button><div class="vp-local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-3944d8e8 data-v-4114a62c><button data-v-4114a62c>返回顶部</button><!----></div></div><aside class="vp-sidebar" vp-sidebar data-v-d90a7a26 data-v-95211354><div class="curtain" data-v-95211354></div><nav id="SidebarNav" class="nav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-95211354><span id="sidebar-aria-label" class="visually-hidden" data-v-95211354> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-473fd05b><section class="vp-sidebar-item sidebar-item level-0 collapsible is-link" data-v-473fd05b data-v-12048f0f><div class="item" tabindex="0" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/Golang/" data-v-12048f0f><!--[--><h2 class="text" data-v-12048f0f><span data-v-12048f0f>Golang</span><!----></h2><!--]--><!----></a><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-12048f0f><span class="vpi-chevron-right caret-icon" data-v-12048f0f></span></div></div><div data-v-12048f0f data-v-12048f0f><div class="items" data-v-12048f0f><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/go/%E5%9F%BA%E7%A1%80%E7%AF%87/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>基础篇</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/go/%E8%BF%9B%E9%98%B6%E7%AF%87/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>进阶篇</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/go/%E5%8E%9F%E7%90%86%E7%AF%87/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>原理篇</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><div class="no-transition group" data-v-473fd05b><section class="vp-sidebar-item sidebar-item level-0 collapsible is-link has-active" data-v-473fd05b data-v-12048f0f><div class="item" tabindex="0" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/PHP/" data-v-12048f0f><!--[--><h2 class="text" data-v-12048f0f><span data-v-12048f0f>PHP</span><!----></h2><!--]--><!----></a><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-12048f0f><span class="vpi-chevron-right caret-icon" data-v-12048f0f></span></div></div><div data-v-12048f0f data-v-12048f0f><div class="items" data-v-12048f0f><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/php/%E5%9F%BA%E7%A1%80%E7%AF%87/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>基础篇</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/php/%E8%BF%9B%E9%98%B6%E7%AF%87/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>进阶篇</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/php/%E5%AF%B9%E6%AF%94%E7%AF%87/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>对比篇</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/php/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%AF%87/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>面向对象篇</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/php/%E7%AE%97%E6%B3%95%E6%8E%92%E5%BA%8F%E7%AF%87/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>算法排序篇</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/php/%E5%AE%9E%E8%B7%B5%E7%AF%87/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>实践篇</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><div class="no-transition group" data-v-473fd05b><section class="vp-sidebar-item sidebar-item level-0 collapsible" data-v-473fd05b data-v-12048f0f><div class="item" role="button" tabindex="0" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><h2 class="text" data-v-12048f0f><span data-v-12048f0f>数据库</span><!----></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-12048f0f><span class="vpi-chevron-right caret-icon" data-v-12048f0f></span></div></div><div data-v-12048f0f data-v-12048f0f><div class="items" data-v-12048f0f><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/mysql/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>MySQL</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/redis/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Redis</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/mongodb/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>MongoDB</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><div class="no-transition group" data-v-473fd05b><section class="vp-sidebar-item sidebar-item level-0 collapsible" data-v-473fd05b data-v-12048f0f><div class="item" role="button" tabindex="0" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><h2 class="text" data-v-12048f0f><span data-v-12048f0f>服务器</span><!----></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-12048f0f><span class="vpi-chevron-right caret-icon" data-v-12048f0f></span></div></div><div data-v-12048f0f data-v-12048f0f><div class="items" data-v-12048f0f><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/nginx/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>nginx</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><div class="no-transition group" data-v-473fd05b><section class="vp-sidebar-item sidebar-item level-0 collapsible" data-v-473fd05b data-v-12048f0f><div class="item" role="button" tabindex="0" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><h2 class="text" data-v-12048f0f><span data-v-12048f0f>消息队列</span><!----></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-12048f0f><span class="vpi-chevron-right caret-icon" data-v-12048f0f></span></div></div><div data-v-12048f0f data-v-12048f0f><div class="items" data-v-12048f0f><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/RabbitMQ/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>RabbitMQ</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><div class="no-transition group" data-v-473fd05b><section class="vp-sidebar-item sidebar-item level-0 collapsible" data-v-473fd05b data-v-12048f0f><div class="item" role="button" tabindex="0" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><h2 class="text" data-v-12048f0f><span data-v-12048f0f>网络通信</span><!----></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-12048f0f><span class="vpi-chevron-right caret-icon" data-v-12048f0f></span></div></div><div data-v-12048f0f data-v-12048f0f><div class="items" data-v-12048f0f><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/http/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>http</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/interview/session_cookie/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>session和cookie</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><!--]--><!--[--><!--]--></nav></aside><!--[--><div id="VPContent" vp-content class="vp-content has-sidebar" data-v-d90a7a26 data-v-b2beaca7><div class="vp-doc-container has-sidebar has-aside" data-v-b2beaca7 data-v-23f6ad98><!--[--><!--]--><div class="container" data-v-23f6ad98><div class="aside" vp-outline data-v-23f6ad98><div class="aside-curtain" data-v-23f6ad98></div><div class="aside-container" data-v-23f6ad98><div class="aside-content" data-v-23f6ad98><div class="vp-doc-aside" data-v-23f6ad98 data-v-5976474c><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="vp-doc-aside-outline" role="navigation" data-v-5976474c data-v-aa56eba0><div class="content" data-v-aa56eba0><div class="outline-marker" data-v-aa56eba0></div><div id="doc-outline-aria-label" aria-level="2" class="outline-title" role="heading" data-v-aa56eba0><span data-v-aa56eba0>此页内容</span><span class="vpi-print icon" data-v-aa56eba0></span></div><ul class="root" data-v-aa56eba0 data-v-3e6b023c><!--[--><!--]--></ul></div></nav><!--[--><!--[--><!--[--><!--[--><div class="aside-nav-wrapper" data-v-d90a7a26 data-v-45e94c4e><a class="vp-link link no-icon link" href="https://github.com/sreio/sreio-docs" target="_blank" rel="noreferrer" data-v-45e94c4e><!--[--><span class="vpi-github-star" data-v-45e94c4e></span><span class="link-text" data-v-45e94c4e>在 GitHub 上 Star</span><span class="vpi-arrow-right" data-v-45e94c4e></span><!--]--><!----></a><a class="vp-link link no-icon link" href="https://github.com/sreio/sreio-docs/issues/new/choose" target="_blank" rel="noreferrer" data-v-45e94c4e><!--[--><span class="vpi-github-issue" data-v-45e94c4e></span><span class="link-text" data-v-45e94c4e>遇到问题？</span><span class="vpi-arrow-right" data-v-45e94c4e></span><!--]--><!----></a></div><!--]--><!--]--><!--]--><!--]--><div class="spacer" data-v-5976474c></div><!--[--><!--]--></div></div></div></div><div class="content" data-v-23f6ad98><div class="content-container" data-v-23f6ad98><!--[--><!--]--><main class="main" data-v-23f6ad98><nav class="vp-breadcrumb" data-v-23f6ad98 data-v-1ae4ad7a><ol vocab="https://schema.org/" typeof="BreadcrumbList" data-v-1ae4ad7a><!--[--><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link link breadcrumb" href="/" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->首页<!--]--><!----></a><span class="vpi-chevron-right" data-v-1ae4ad7a></span><meta property="name" content="首页" data-v-1ae4ad7a><meta property="position" content="1" data-v-1ae4ad7a></li><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link link breadcrumb" href="/interview/PHP/" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->PHP<!--]--><!----></a><span class="vpi-chevron-right" data-v-1ae4ad7a></span><meta property="name" content="PHP" data-v-1ae4ad7a><meta property="position" content="2" data-v-1ae4ad7a></li><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link link breadcrumb current" href="/interview/php/%E8%BF%9B%E9%98%B6%E7%AF%87/" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->进阶篇<!--]--><!----></a><!----><meta property="name" content="进阶篇" data-v-1ae4ad7a><meta property="position" content="3" data-v-1ae4ad7a></li><!--]--></ol></nav><!--[--><!--]--><!--[--><h1 class="vp-doc-title page-title" data-v-27be53cb>进阶篇 <!----></h1><div class="vp-doc-meta" data-v-27be53cb><!--[--><!--]--><p class="reading-time" data-v-27be53cb><span class="vpi-books icon" data-v-27be53cb></span><span data-v-27be53cb>约 1837 字</span><span data-v-27be53cb>大约 6 分钟</span></p><!----><!--[--><!--]--><p class="create-time" data-v-27be53cb><span class="vpi-clock icon" data-v-27be53cb></span><span data-v-27be53cb>2025-07-07</span></p></div><!--]--><!--[--><!--]--><div class="_interview_php_%E8%BF%9B%E9%98%B6%E7%AF%87_ external-link-icon-enabled vp-doc plume-content" vp-content data-v-23f6ad98><!--[--><!--]--><div data-v-23f6ad98><h2 id="php垃圾回收机制-gc" tabindex="-1"><a class="header-anchor" href="#php垃圾回收机制-gc"><span>PHP垃圾回收机制（GC）</span></a></h2><ul><li><ol><li>使用 引用计数机制</li></ol></li><li><ol start="2"><li>将每个 PHP 变量保存在一个叫 zval 变量容器中。</li></ol></li><li><ol start="3"><li>zval 变量容器 包含 变量的类型、变量值、 is_res、refcount</li></ol></li><li><ol start="4"><li><code>is_ref</code> 用于标识该变量是否为引用集合或变量。</li></ol></li><li><ol start="5"><li>refcount 表示指向当前变量的个数。</li></ol></li><li><ol start="6"><li>默认打开垃圾回收机制, 当发现有存在循环引用的zval时, 就会把其投入到根缓冲区, 当根缓冲区达到配置文件中的指定数量后, 就会进行垃圾回收, 以此解决8. 循环引用导致的内存泄露问题</li></ol></li><li><ol start="7"><li>如果引用计数减少到零, 所在变量容器将被清除（free）, 不属于垃圾；</li></ol></li><li><ol start="8"><li>如果一个zval的引用计数减少后还大于0, 那么它会进入垃圾周期。</li></ol></li><li><ol start="9"><li>其次, 在一个垃圾周期中, 通过检查引用计数是否减1, 并且检查哪些变量容器的引用次数是零, 来发现哪部分是垃圾。</li></ol></li></ul><h2 id="php底层原理" tabindex="-1"><a class="header-anchor" href="#php底层原理"><span>PHP底层原理</span></a></h2><h3 id="php代码执行过程" tabindex="-1"><a class="header-anchor" href="#php代码执行过程"><span>PHP代码执行过程：</span></a></h3><ol><li>启动 php 及 zend 引擎</li><li>加载注册拓展模块</li><li>对代码进行词法/语法分析</li><li>编译成opcode(opcache)</li><li>执行 opcode</li></ol><h3 id="php-的四层体系-从下至上分为四层" tabindex="-1"><a class="header-anchor" href="#php-的四层体系-从下至上分为四层"><span>PHP 的四层体系, 从下至上分为四层:</span></a></h3><ul><li>Zend 引擎 <ul><li>Zend 引擎整体用C语言实现，是 PHP 的内核部分，它负责将 PHP 代码翻译（词法、语法解析等一系列编译过程）为可执行的 opcode 操作码，并实现相应的处理方法、基本的数据结构（如 hashtable、OO）、内存分配及管理、提供相应的 API 方法供外部调用。</li></ul></li><li>扩展层 <ul><li>围绕着 Zend 引擎，Extensions 通过组件化的方式提供各种基础服务，我们常见的各种内置函数（例如变量操作函数、字符串操作函数等）以及标准库等都是通过 Extensions 来实现。</li></ul></li><li>SAPI（服务器应用程序编程接口） <ul><li>SAPI 通过一系列钩子函数，使得 PHP 可以和外围交互数据，这是 PHP 非常优雅和成功的一个设计，通过 SAPI 成功的将 PHP 本身和上层应用解耦隔离，PHP 可以不再考虑如何针对不同应用进行兼容，而应用本身也可以针对自己的特点实现不同的处理方式。</li></ul></li><li>Application（上层应用）</li></ul><figure><img src="/assets/dc-DSJReGOC.png" alt="img" tabindex="0" loading="lazy" width="476" height="500"><figcaption>:size=50%</figcaption></figure><h2 id="php运行模式以及各自的原理" tabindex="-1"><a class="header-anchor" href="#php运行模式以及各自的原理"><span>PHP运行模式以及各自的原理</span></a></h2><h3 id="先了解一下-cgi" tabindex="-1"><a class="header-anchor" href="#先了解一下-cgi"><span>先了解一下 CGI :</span></a></h3><ul><li>CGI（Common Gateway Interface）全称是“通用网关接口”，是一种让 客户端 与 Web服务器 程序进行通信（数据传输）的协议。</li><li>CGI 用来规范 Web服务器 传输到 解析器(例: php-cgi) 中的数据类型以及数据格式，包括URL、查询字符串、POST数据、HTTP header等。</li><li>解析器只要符合 CGI 标准，就能作为一个 cgi 程序与 Web 服务器交互。</li><li>一次请求都要 fork 一个进程, 然后销毁，也就是（fork-and-execute）模式，性能较低。</li></ul><h4 id="php-运行模式" tabindex="-1"><a class="header-anchor" href="#php-运行模式"><span>PHP 运行模式:</span></a></h4><ul><li><p>FastCGI</p><ul><li>FastCGI（Fast Common Gateway Interface）全称是“快速通用网关接口”，也是一种让 客户端 与 Web服务器 程序进行通信（数据传输）的协议。。</li><li><code>FastCGI</code> 是 <code>CGI</code> 模式的升级版, 目的是避免重复解析配置文件和初始执行环境。</li><li>像是一个常驻型 <code>CGI</code> , 可以一直处理请求不结束该进程。</li><li>多进程，将比 <code>CGI</code> 消耗更多的服务器内存。</li><li>可平滑停止/启动进程。</li></ul></li><li><p>PHPCGI</p><ul><li>一个 <code>CGI</code> 程序，是 PHP 实现 <code>CGI</code> 的 PHP解析器。</li><li>用于解析请求，返回结果。</li><li>不可平滑重启。</li></ul></li><li><p>PHP-FPM</p><ul><li><code>PHP-FPM</code> 为 <code>FastCGI</code> 的进程管理器。</li><li>工作原理为:</li><li>Web 服务器启动时，加载启动 <code>PHP-FPM</code>，<code>PHP-FPM</code> 读取配置文件，初始化运行环境。</li><li><code>PHP-FPM</code> 创建一个 Master 主进程和若干个 Worker 进程，负责监听端口，等待接收请求，每个进程内都调用一个 <code>PHP-CGI</code>。</li><li>用户发起请求, Web服务器接收请求并转发给 <code>PHP-FPM</code>，空闲的 Worker 进程以抢占式的接收该请求。</li><li>监听接收后，<code>PHPCGI</code> 解析请求，开始执行业务处理代码, 处理完成后，按照 CGI 规定的格式返给 Worker 进程, 然后退出进程, 此时 Worker 进程变成空闲状态等待下次请求。</li><li>Worker 进程将结果返给 Web服务器, Web服务器接收返回内容并返回给客户端。</li></ul></li><li><p>MODULE</p><ul><li><code>apache + php</code> 运行时，默认使用的是 <code>module 模式</code>，它把 php 作为 <code>apache</code> 的模块随 <code>apache</code> 启动而启动，接收到用户请求时则直接通过调用 <code>mod_php 模块</code> 进行处理。</li></ul></li><li><p>PHP-CLI</p><ul><li><code>PHP-CLI 模式</code> 属于命令行模式</li><li>在终端直接输入 <code>php 文件名.php</code> 就可直接运行代码</li><li>没有超时时间</li><li><code>echo</code>、<code>var_dump</code>、<code>phpinfo</code> 等输出会直接打印到控制台中</li></ul></li></ul><h2 id="php-数组底层原理" tabindex="-1"><a class="header-anchor" href="#php-数组底层原理"><span>PHP 数组底层原理</span></a></h2><ol><li><p>底层实现是通过散列表（hash table） + 双向链表（解决hash冲突）</p><ol><li>hashtable：将不同的关键字（key）通过映射函数计算得到散列值（Bucket-&gt;h） 从而直接索引到对应的Bucket</li><li>hash表保存当前循环的指针, 所以foreach 比for更快</li><li>Bucket：保存数组元素的key和value, 以及散列值h</li></ol></li><li><p>如何保证有序性</p><ol><li>散列函数和元素数组（Bucket）中间添加一层大小和存储元素数组相同的映射表。</li><li>用于存储元素在实际存储数组中的下标</li><li>元素按照映射表的先后顺序插入实际存储数组中</li><li>映射表只是原理上的思路, 实际上并不会有实际的映射表, 而是初始化的时候分配Bucket内存的同时, 还会分配相同数量的 uint32_t 大小的空间, 然后将 arData 偏移到存储元素数组的位置。</li></ol></li><li><p>解决hash重复(php使用的链表法)：</p><ol><li>链表法:不同关键字指向同一个单元时, 使用链表保存关键字（遍历链表匹配key）</li><li>开放寻址法：当关键字指向已经存在数据的单元的时候, 继续寻找其他单元, 直到找到可用单元（占用其他单元位置, 更容易出现hash冲突, 性能下降）</li></ol></li><li><p>基础知识</p><ol><li>链表：队列、栈、双向链表</li><li>链表：元素 + 指向下一元素的指针</li><li>双向链表：指向上一元素的指针 + 元素 + 指向下一元素的指针</li></ol></li></ol><h2 id="依赖注入实现方式" tabindex="-1"><a class="header-anchor" href="#依赖注入实现方式"><span>依赖注入实现方式</span></a></h2><ol><li>构造函数依赖注入（如果依赖的类多，就会造成构造函数的形参特别多）</li><li>set 方式注入（如果依赖的类多，那 set 的方法也特别多）</li><li>采用类似 Laravel 服务容器 实现依赖注入（调用时使用闭包，这样就做到 使用才实例化）</li></ol><h2 id="php-内存溢出解决" tabindex="-1"><a class="header-anchor" href="#php-内存溢出解决"><span>PHP 内存溢出解决</span></a></h2><ol><li>增加 PHP 可用内存大小</li><li>对大数组分批处理或 yield 处理</li><li>及时销毁大数组或变量</li><li>根据业务规则，尽可能的少用 静态变量</li><li>数据库操作完，及时关闭</li></ol></div><!--[--><h2 id="doc-contributors" tabindex="-1"><a href="#doc-contributors" class="header-anchor"><span>贡献者</span></a></h2><div class="vp-contributors"><a href="https://github.com/sreio" target="_blank" rel="noreferrer" class="vp-contributor"><img src="https://avatars.githubusercontent.com/sreio?v=4" alt class="vp-contributor-avatar"><span class="vp-contributor-name">sreio</span></a></div><!--]--><!--[--><h2 id="doc-changelog" tabindex="-1"><a href="#doc-changelog" class="header-anchor"><span>更新日志</span></a></h2><div class="vp-changelog-wrapper"><div class="vp-changelog-header"><div class="vp-latest-updated"><span class="vp-changelog-icon"></span><span data-allow-mismatch>2025/7/7 08:48</span></div><div><span class="vp-changelog-menu-icon"></span><span>查看所有更新日志</span></div></div><ul class="vp-changelog-list"><!--[--><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/sreio/sreio-docs/commit/066c6248983ad7feba746c5bfc01203e48752ed3" target="_blank" rel="noreferrer"><code>066c6</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">面试</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-07-07T08:48:09.000Z">2025/7/7</time></span></li><li class="vp-changelog-item-commit"><a class="vp-changelog-hash" href="https://github.com/sreio/sreio-docs/commit/5be24b01f97e53b886885abde519c2e0cc6b3447" target="_blank" rel="noreferrer"><code>5be24</code></a><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">面试</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-07-07T08:44:18.000Z">2025/7/7</time></span></li><!--]--></ul></div><!--]--><!----></div></main><footer class="vp-doc-footer" data-v-23f6ad98 data-v-fda6bbae><!--[--><!--]--><div class="edit-info" data-v-fda6bbae><div class="edit-link" data-v-fda6bbae><a class="vp-link link no-icon edit-link-button" href="https://github.com/sreio/sreio-docs/edit/main/docs/interview/PHP/2.进阶篇.md" target="_blank" rel="noreferrer" data-v-fda6bbae><!--[--><span class="vpi-square-pen edit-link-icon" aria-label="edit icon" data-v-fda6bbae></span> 编辑此页<!--]--><!----></a></div><!----></div><!----><nav class="prev-next" data-v-fda6bbae><div class="pager" data-v-fda6bbae><a class="vp-link link pager-link prev" href="/interview/php/%E5%9F%BA%E7%A1%80%E7%AF%87/" data-v-fda6bbae><!--[--><span class="desc" data-v-fda6bbae>上一页</span><span class="title" data-v-fda6bbae>基础篇</span><!--]--><!----></a></div><div class="pager" data-v-fda6bbae><a class="vp-link link pager-link next" href="/interview/php/%E5%AF%B9%E6%AF%94%E7%AF%87/" data-v-fda6bbae><!--[--><span class="desc" data-v-fda6bbae>下一页</span><span class="title" data-v-fda6bbae>对比篇</span><!--]--><!----></a></div></nav></footer><!----><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button style="display:none;" type="button" class="vp-back-to-top" aria-label="back to top" data-v-d90a7a26 data-v-bcf8d9a6><span class="percent" data-allow-mismatch data-v-bcf8d9a6>0%</span><span class="show icon vpi-back-to-top" data-v-bcf8d9a6></span><svg aria-hidden="true" data-v-bcf8d9a6><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-bcf8d9a6></circle></svg></button><footer class="vp-footer has-sidebar" vp-footer data-v-d90a7a26 data-v-400675cf><!--[--><div class="container" data-v-400675cf><p class="message" data-v-400675cf>Sreio Docs </p><!----></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/assets/app-DWByWgeb.js" defer></script></body></html>