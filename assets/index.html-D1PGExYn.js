import{_ as i,c as a,e as n,o as e}from"./app-DWByWgeb.js";const l={};function t(h,s){return e(),a("div",null,s[0]||(s[0]=[n(`<p>本章介绍MongoDB地理位置查询功能之一，根据距离查询文档数据。</p><p>应用场景：查询附近店铺、附近的人。</p><h2 id="前置教程" tabindex="-1"><a class="header-anchor" href="#前置教程"><span>前置教程</span></a></h2><p><a href="/#/数据库/mongodb/position/model.md">MongoDB地理位置存储格式</a></p><ul><li>根据距离查询数据的前置条件如下： <ul><li>每个文档数据中有保存坐标数据的字段，例如: location字段保存店铺坐标。</li><li>创建2dsphere 或者 2d 空间索引。</li></ul></li></ul><h2 id="near操作符" tabindex="-1"><a class="header-anchor" href="#near操作符"><span>$near操作符</span></a></h2><p>MongoDB通过$near操作符实现根据距离查询文档数据。</p><p>格式：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">   &lt;</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">location</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> fiel</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">d</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> //</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 保存坐标数据的字段</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">     $near</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">       $geometry</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> //</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 设置作为对比的基准坐标</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">          type</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Point</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ,</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">          coordinates:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [ </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">经度</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 纬度</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ]</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">       }</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">       $maxDistance</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 最大距离，单位米,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">       $minDistance</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 最小距离，单位米</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">     }</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">   }</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示：$near查询返回的数据，按距离由近到远排序。</p></div><h2 id="例子" tabindex="-1"><a class="header-anchor" href="#例子"><span>例子</span></a></h2><p>假如shop集合保存了店铺数据，location字段保存每一个店铺的坐标，下面查询距离我最近的店铺（最小距离1000米，最大距离5000米）。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">db.shop.find(</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">   {</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">     location:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">       {</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $near</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> :</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">          {</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            $geometry</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> type:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Point</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  coordinates:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [ </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-73.9667,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 40.78</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ]</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> },</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> //</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 我的坐标</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            $minDistance</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 1000,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> //</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 最小距离</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            $maxDistance</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5000</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> //</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 最大距离</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">          }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">       }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">   }</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,13)]))}const k=i(l,[["render",t]]),d=JSON.parse('{"path":"/mongodb/%E6%8C%89%E8%B7%9D%E7%A6%BB%E6%90%9C%E7%B4%A2/","title":"按距离搜索","lang":"zh-CN","frontmatter":{"title":"按距离搜索","createTime":"2025/07/07 18:31:20","permalink":"/mongodb/按距离搜索/","description":"本章介绍MongoDB地理位置查询功能之一，根据距离查询文档数据。 应用场景：查询附近店铺、附近的人。 前置教程 MongoDB地理位置存储格式 根据距离查询数据的前置条件如下： 每个文档数据中有保存坐标数据的字段，例如: location字段保存店铺坐标。 创建2dsphere 或者 2d 空间索引。 $near操作符 MongoDB通过$near操...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"按距离搜索\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-12-29T16:03:14.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://docs.sreio.com/mongodb/%E6%8C%89%E8%B7%9D%E7%A6%BB%E6%90%9C%E7%B4%A2/"}],["meta",{"property":"og:site_name","content":"Sreio Docs"}],["meta",{"property":"og:title","content":"按距离搜索"}],["meta",{"property":"og:description","content":"本章介绍MongoDB地理位置查询功能之一，根据距离查询文档数据。 应用场景：查询附近店铺、附近的人。 前置教程 MongoDB地理位置存储格式 根据距离查询数据的前置条件如下： 每个文档数据中有保存坐标数据的字段，例如: location字段保存店铺坐标。 创建2dsphere 或者 2d 空间索引。 $near操作符 MongoDB通过$near操..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-12-29T16:03:14.000Z"}],["meta",{"property":"article:modified_time","content":"2025-12-29T16:03:14.000Z"}]]},"readingTime":{"minutes":1.03,"words":308},"git":{"createdTime":1751885168000,"updatedTime":1767024194000,"contributors":[{"name":"sreio","username":"sreio","email":"ingwei@163.com","commits":3,"avatar":"https://avatars.githubusercontent.com/sreio?v=4","url":"https://github.com/sreio"}],"changelog":[{"hash":"6dd596b6752ea1c49be57e00b1b0c941c0324a5d","time":1767024194000,"email":"ingwei@163.com","author":"sreio","message":"feat: Add new documentation across Go, PHP, Docker, Linux, Database, Middleware, and Fundamentals, while removing some old images and files."},{"hash":"392e0717075550911bee8967562578d34bf94c89","time":1752462858000,"email":"ingwei@163.com","author":"sreio","message":"updated: fixed tip"},{"hash":"c1ab990bb57919c348cc77b4236368714def9959","time":1751885168000,"email":"ingwei@163.com","author":"sreio","message":"elk&#x26;clickhouse&#x26;redis&#x26;mongdb&#x26;etcd"}]},"autoDesc":true,"filePathRelative":"database/mongodb/6.地理位置查询/2.distance.md","headers":[]}');export{k as comp,d as data};
